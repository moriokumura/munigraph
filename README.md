# 概要

- 日本の自治体の廃置分合について学べるリファレンス兼クイズアプリ
- Webブラウザのクライアントサイドのみで完結し、ユーザー認証などは行わない

## システム構成
- Vue 3
- TypeScypt
- Vite
- Pinia
- ESlint
- Tailwind CSS

### 検討
- Cytoscape

## 用意するデータ

### データの種類
- 都道府県マスタレコード (prefectures.csv) (47)
- 郡・政令区・支庁・振興局マスタレコード (counties.csv)  (500)
- 市区町村マスタレコード (cities.csv) (1万〜)
  - valid_toが空欄ならば現存の市区町村とみなす
  - 同じ自治体でも合併や分裂、町制や市制の施行が生じた場合は別レコード
- 廃置分合イベントレコード (change_events.csv)  (3000〜)
  - 1行で１市区町村の変化のみを扱う。N個の自治体が1自治体に合併した場合はN行のレコードとなる。

### データ形式と処理
- 元データはCSVファイル, UTF-8（軽量かつ編集しやすいため）
- アプリケーションがCSVを全て読み込みメモリ内にツリー構造で持つ
- codeは0-9の数字文字列からのみなる文字列とする
- 読みがな(yomi)はひらがな表記とする
- nameの旧字は新字にせずそのままの表記とする
- dateが同日のeventの順序は不定でよい(順序が必要になったときには再検討)
- event_typeは便宜上change_envents.csvに直書きしているが、種類を限定しtsのソースコード内に定義したい。

## アプリケーション挙動（クイズモード）
- イベントレコードからランダムに出題
  マスタレコードを引いて郡や市区町村名を表示
  名称をランダムにマスク
  マスクされた箇所を文字列入力して正否を表示

## アプリケーション挙動（ブラウズモード）
- 現存の市区町村名を表示
- または自治体名を検索して該当する自治体を表示
- クリックで１つ過去のイベントと祖先自治体を表示

---

## 開発環境・基本コマンド

プロジェクトルートで以下のコマンドを実行してください。

### 依存パッケージのインストール
```
npm install
```

### 開発サーバーの起動
```
npm run dev
```

### 本番用ビルド
```
npm run build
```

### Lint（コードチェック）
```
npm run lint
```

### ビルド成果物のプレビュー
```
npm run preview
```

## 既知の問題とToDo

優先
- ロジックの混乱を解消
- GitHubでのバックアップ
- web公開

#### 元データ変換ミス・漏れ
- [ ] 伊奈町・村、横越町・村などの順序が逆になっている
- [ ] 広島県双三郡三和町が神石郡三和町と混同されて間違って現存扱いになっている

#### 元データ不足
- 明治期〜1970年頃の期間のデータがない
- 舟橋村など、廃置分合イベントが起きていない自治体が抜けている
- 東京23区もない

### 仕様
- 政令指定都市の区の扱い

### 解決済み
- [x] 市制施行・町制施行
  - イベントがchange_events.csvに含まれていない
  - 前の自治体のvalid_toも空なので存続扱いにされている
- [x] 新設合併で同名の自治体を新設した場合、valid_toに日付が入り消滅扱いになる
- [x] 1974-06-01,井川村(05366)が井川町(05366)に町制施行 のようにコードが変化してない場合があるので独自にIDを振る
- [x] 長野市の編入イベントを遡っていくことができない
- [x] 自治体の成立時期(valid_from)データを追加し画面に表示