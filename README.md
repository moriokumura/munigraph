# 概要

- 日本の自治体の廃置分合について学べるリファレンス兼クイズアプリ
- Webブラウザのクライアントサイドのみで完結し、ユーザー認証などは行わない

## システム構成

- Vue 3
- TypeScypt
- Vite
- Pinia
- ESlint
- Tailwind CSS

## 用意するデータ

### データの種類

- 都道府県マスタレコード (`prefectures.csv`) (47)
- 郡マスタレコード (`counties.csv`) (600〜)
- 支庁マスタレコード (`subprefectures.csv`) (100)
- 自治体マスタレコード (`municipalities.csv`) (数千〜)
  - 自治体のアイデンティティ（代表的な名称、読み、所属都道府県）を定義
  - 独自ID（Mxxxxx）を持ち、名称が変わらない限り同一エンティティとして扱う
- 自治体バージョンレコード (`municipality_versions.csv`) (4k〜)
  - 特定の期間における自治体の属性（名称、読み、JISコード、支庁、郡）を保持
  - 同一ID内での微細な名称変更（旧字体の変更など）も、このレコードの `name` 列で表現する
  - `valid_to` が空欄のレコードが現存する自治体を表す
- 廃置分合イベントレコード (`change_events.csv`) (2k〜)
  - 合併・編入・新設など、自治体エンティティ間を跨ぐ変化を記録
  - 自治体ID（Mxxxxx）と日付を用いて、どのバージョンの変化かを論理的に紐付ける
  - 同一自治体内の属性変更（支庁変更、郡の変更、JISコードの変更）は、バージョン間の差分としてアプリケーションが自動検知するため、このファイルには記述しない

### データ形式と処理

- 元データはCSVファイル, UTF-8（軽量かつ編集しやすいため）
- アプリケーションがCSVを全て読み込みメモリ内に保持する
- ID（Mxxxxx）は文字列とする
- 読みがな(yomi)はひらがな表記とする
- nameの旧字は新字にせずそのままの表記とする
- dateが同日のeventの順序は不定でよい(順序が必要になったときには再検討)
- `event_type` はソースコード内（`src/types/municipality.ts`）で厳密に定義され、文脈（誕生側か消滅側か）に応じて最適な表示名が選択される。

## アプリケーション挙動（クイズモード）

- イベントレコードからランダムに出題
  マスタレコードを引いて郡や自治体名を表示
  名称をランダムにマスク
  マスクされた箇所を文字列入力して正否を表示

## アプリケーション挙動（ブラウズモード）

- 現存の自治体名を表示
- または自治体名を検索して該当する自治体を表示
- 1つの自治体を選択すると、その自治体の変遷（バージョン）をタイムライン形式で表示
- 各バージョンにおける属性（郡、支庁）や、その前後に発生した廃置分合イベントを表示

---

## 開発環境・基本コマンド

プロジェクトルートで以下のコマンドを実行してください。

### 依存パッケージのインストール

```
npm install
```

### 開発サーバーの起動

```
npm run dev
```

### 本番用ビルド

```
npm run build
```

### Lint

```
npm run lint
```

### Test

```
npm run test
```

### ビルド成果物のプレビュー

```
npm run preview
```

### デプロイ

- mainブランチにpushするとGHAによりGitHub Pagesにデプロイされます。
- https://moriokumura.github.io/munigraph/#/browse
