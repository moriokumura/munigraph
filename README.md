# 概要

- 日本の自治体の廃置分合について学べるリファレンス兼クイズアプリ
- Webブラウザのクライアントサイドのみで完結し、ユーザー認証などは行わない

## システム構成

- Vue 3
- TypeScypt
- Vite
- Pinia
- ESlint
- Tailwind CSS

## 用意するデータ

### データの種類

- 都道府県マスタレコード (prefectures.csv) (47)
- 郡マスタレコード (counties.csv) (600〜)
- 支庁マスタレコード (subprefectures.csv) (100)
- 市区町村マスタレコード (cities.csv) (10k〜)
  - valid_toが空欄ならば現存の市区町村とみなす
  - アプリケーション内部では、`city_code`と名称が同一のレコードを1つの「自治体エンティティ」として集約して管理する
  - 同じ自治体でも属性変更（支庁変更や編入など）が生じた場合は別レコードとしてCSVに保持されるが、同一エンティティの「バージョン」として扱われる
- 廃置分合イベントレコード (change_events.csv) (10k〜)
  - 1行で１市区町村の変化のみを扱う。N個の自治体が1自治体に合併した場合はN行のレコードとなる。

### データ形式と処理

- 元データはCSVファイル, UTF-8（軽量かつ編集しやすいため）
- アプリケーションがCSVを全て読み込みメモリ内にツリー構造で持つ
- codeは0-9の数字文字列からのみなる文字列とする
- 読みがな(yomi)はひらがな表記とする
- nameの旧字は新字にせずそのままの表記とする
- dateが同日のeventの順序は不定でよい(順序が必要になったときには再検討)
- event_typeは便宜上change_envents.csvに直書きしているが、種類を限定しtsのソースコード内に定義したい。

## アプリケーション挙動（クイズモード）

- イベントレコードからランダムに出題
  マスタレコードを引いて郡や市区町村名を表示
  名称をランダムにマスク
  マスクされた箇所を文字列入力して正否を表示

## アプリケーション挙動（ブラウズモード）

- 現存の自治体名を表示
- または自治体名を検索して該当する自治体を表示
- 1つの自治体を選択すると、その自治体の変遷（バージョン）をタイムライン形式で表示
- 各バージョンにおける属性（郡、支庁）や、その前後に発生した廃置分合イベントを表示

---

## 開発環境・基本コマンド

プロジェクトルートで以下のコマンドを実行してください。

### 依存パッケージのインストール

```
npm install
```

### 開発サーバーの起動

```
npm run dev
```

### 本番用ビルド

```
npm run build
```

### Lint

```
npm run lint
```

### Test

```
npm run test
```

### ビルド成果物のプレビュー

```
npm run preview
```

### デプロイ

- mainブランチにpushするとGHAによりGitHub Pagesにデプロイされます。
- https://moriokumura.github.io/munigraph/#/browse
